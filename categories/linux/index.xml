<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>linux on technical_</title><link>https://blog.agramakov.me/categories/linux/</link><description>Recent content in linux on technical_</description><generator>Hugo</generator><language/><lastBuildDate>Sun, 18 Sep 2022 21:48:21 +0100</lastBuildDate><atom:link href="https://blog.agramakov.me/categories/linux/index.xml" rel="self" type="application/rss+xml"/><item><title>Zakhar Brain Service</title><link>https://blog.agramakov.me/posts/2022/09-18-zakhar-brain-service/</link><pubDate>Sun, 18 Sep 2022 21:48:21 +0100</pubDate><guid>https://blog.agramakov.me/posts/2022/09-18-zakhar-brain-service/</guid><description><p>Yesterday I merged a big software update to the Zakhar&rsquo;s Raspberry Pi Unit -<code>brain_service</code>.</p><p>The update brings a service providing the robot&rsquo;s status (network, OS status) and access to the CAN bus for many simultaneously connected clients. Also, the service tracks the presence of other robot Units on the CAN bus.</p><p>There is another service shipping with the same repository<code>brain_service_display</code>. This service connects to<code>brain_service</code> and shows some important information on a small OLED display:</p><p><img class="img-zoomable" src="screen1.jpg" alt=""/><img class="img-zoomable" src="screen2.jpg" alt=""/><img class="img-zoomable" src="screen3.jpg" alt=""/></p><ul><li>f - Face Unit</li><li>S - Sensor Unit</li><li>m - Wheeled moving platform (&ldquo;Motors&rdquo;)</li><li>t - Service Unit (&ldquo;Tool&rdquo;)</li></ul><p>The service structure is presented below:</p><p><img class="img-zoomable" src="structure.svg" alt=""/></p><p>The service publishes status information and incoming CAN messages to<a href="https://zeromq.org/" target="_blank">ZeroMQ</a> subscribers. The service allows all TCP connections including connections from external machines. See<a href="https://github.com/Zakhar-the-Robot/brain_pycore" target="_blank">brain_pycore</a> for compatible subscriber and client implementation classes.</p><p>Sources:</p><ul><li><a href="https://github.com/Zakhar-the-Robot/brain_service" target="_blank">https://github.com/Zakhar-the-Robot/brain_service</a></li><li><a href="https://github.com/Zakhar-the-Robot/brain_pycore" target="_blank">https://github.com/Zakhar-the-Robot/brain_pycore</a></li></ul></description></item><item><title>Brain Software Architecture</title><link>https://blog.agramakov.me/posts/2022/08-31-brain-software-architecture/</link><pubDate>Wed, 31 Aug 2022 19:58:42 +0100</pubDate><guid>https://blog.agramakov.me/posts/2022/08-31-brain-software-architecture/</guid><description><p>Before updating Alive OS to support<a href="https://zakhar-the-robot.github.io/doc/docs/communication-protocols/canbus/" target="_blank">qCAN (my CANbus-based protocol)</a> I have the last thing to do. To simplify my live in future I need a CAN publisher that can publish messages to many subscribers. My main subscribe of course is AliveOS but also to display information about connected devices I need a second subscriber - a service listening only qCAN Present messages.</p><p>To do it I will use a<a href="https://zeromq.org/" target="_blank">ZeroMQ protocol</a> - an extremely supported and documented for many programming languages standard. I&rsquo;m going to update my brain_service to support the protocol and it will be responsible for all interaction with Raspberry Pi.</p><p><img class="img-zoomable" src="Brain_Structure.png" alt=""/></p><p>Repositories:</p><ul><li><a href="https://github.com/Zakhar-the-Robot/brain_pycore" target="_blank">https://github.com/Zakhar-the-Robot/brain_pycore</a></li><li><a href="https://github.com/Zakhar-the-Robot/brain_service" target="_blank">https://github.com/Zakhar-the-Robot/brain_service</a></li></ul></description></item><item><title>Setting up Virtual Machine with Ubuntu to work through console in Windows</title><link>https://blog.agramakov.me/posts/2019/01-27-setting-up-virtual-machine-with-ubuntu-to-work-through-console-in-windows/</link><pubDate>Sun, 27 Jan 2019 00:00:00 +0000</pubDate><guid>https://blog.agramakov.me/posts/2019/01-27-setting-up-virtual-machine-with-ubuntu-to-work-through-console-in-windows/</guid><description><p>Here is how to work with Linux inside a virtual machine from Windows using ssh client and VirtualBox. If you will use any command line ssh client you could use all Linux functions right inside your standard Windows Command Line</p><h2 id="0-setup-software-to-the-host">0 Setup Software to the Host</h2><p>Set up VirtualBox, VirtualBox Extension and Ubuntu Server Edition (or Ubuntu Desktop) in a regular mode. I called the machine just: &ldquo;ubuntu&rdquo;</p><h2 id="1-add-virtualbox-setup-directory-to-the-path-variable">1 Add VirtualBox setup directory to the PATH variable</h2><p><code>setx /M path "%path%;"C:\Program Files\Oracle\VirtualBox\""</code></p><p>Note: C:\Program Files\Oracle\VirtualBox\ could be differs</p><h2 id="2-set-up-a-vm-network">2 Set up a VM network</h2><p>Virtual Machine Settings -> Network -> Adapter 2 (tab) -> Attached to: -> Host-only adapter-> OK (button).</p><p><img class="img-zoomable" src="vbox_sets.jpg" alt="vbox_sets.jpg"/></p><h2 id="3-setup-ssh-server-on-the-ubuntu-vm">3 Setup ssh server on the Ubuntu VM</h2><p>Run the virtual machine</p><p>Open a Linux terminal and write:</p><p><code>sudo apt-get install openssh-server nano net-tools</code></p><h3 id="optional-config-the-ssh-server">(Optional) Config the SSH server</h3><p>In a Linux terminal (guest ubuntu):</p><p><code>sudo nano /etc/ssh/sshd_config</code></p><p>And restart SSH server:</p><p><code>sudo systemctl restart ssh.service</code>
 </p><h3 id="optional-set-up-a-non-gui-mode">(Optional) Set up a non-gui mode</h3><p>If you set up Ubuntu Desktop you could turn off GUI at startup to reduce the resource consumption. Even more it is not needed working through a console. In a guest terminal:</p><p><code>sudo systemctl set-default multi-user.target</code></p><p>To turn on GUI again use:</p><p><code>sudo systemctl set-default graphical.target</code></p><h1 id="4-check-your-local-vm-ip">4 Check your local VM IP</h1><p><code>ifconfig</code></p><p>It should be something like <code>192.168.56.101</code>, in my case, at least</p><h1 id="5-close-the-virtual-machine">5 Close the Virtual Machine</h1><p>Do it.</p><h1 id="6-run-vmbox-from-cmd">6 Run VMbox from CMD</h1><p><code>VBoxManage startvm "ubuntu" --type headless</code></p><p>Instead &ldquo;ubuntu&rdquo; you should use your VM name</p><h1 id="7-connect-to-ubuntu-via-any-ssh-client">7 Connect to Ubuntu via any SSH client</h1><p>For example, right from Command Line via ssh from<a href="http://www.cygwin.com/" target="_blank">cygwin</a>:</p><p><code>ssh user@192.168.56.101</code></p><p>Note: change <code>user</code> to your username in guest&rsquo;s VM and<code>192.168.56.101</code>to IP which we checked on the 4th step</p><h1 id="8-use-it">8 Use it!</h1><p>For example like there: <a href="https://docs.espressif.com/projects/esp-idf/en/latest/get-started/linux-setup.html" target="_blank">https://docs.espressif.com/projects/esp-idf/en/latest/get-started/linux-setup.html</a></p><h3 id="optional-connect-usb-device-to-your-working-vm">(Optional) Connect USB device to your working VM</h3><p>In the host cmd get the list of devices:</p><p><code>VBoxManage list usbhost</code></p><p>Connect via UUID:</p><p><code>VBoxManage controlvm ubuntu usbattach f8a9f295-e221-49b0-97a5-aec55d6a2c8c</code></p><h1 id="9-stutdownvmbox-when-youve-done">9 Stutdown** **VMbox when you&rsquo;ve done</h1><p><code>VBoxManage controlvm "ubuntu" poweroff --type headless</code></p><h3 id="optional-mount-ubuntu-home-as-a-drive">(Optional) Mount Ubuntu Home as a drive</h3><p>A. Install <a href="https://github.com/billziss-gh/sshfs-win" target="_blank">SSHFS-Win</a></p><p>B. Open <strong>File Explorer</strong> -> right-click on <strong>This PC</strong> -> <strong>Map network drive</strong> -> in the <strong>Folder</strong> field:</p><p><code>\\sshfs\remoteUser@remoteIP</code></p><h3 id="optional-set-up-a-shared-folder">(Optional) Set up a shared folder</h3><p>A. Inside the host:</p><p>A1. <code>VBoxManage sharedfolder add ubuntu --name esp-repos -automount -hostpath C:\esp\repos</code></p><p>B. Inside the guest:</p><p>B1. </p><div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-1">1</a></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-2">2</a></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-3">3</a></span></code></pre></td><td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>sudo mkdir<span style="color:#8be9fd;font-style:italic">$HOME</span>/host-share/esp-repos</span></span><span style="display:flex;"><span>sudo touch /etc/init.d/vboxmount</span></span><span style="display:flex;"><span>sudo nano /etc/init.d/vboxmount</span></span></code></pre></td></tr></table></div></div><p>B2. Insert:</p><div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-1">1</a></span></code></pre></td><td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>sudo mount -t vboxsf esp-repos /home/agramakov/host-share/esp-repos/</span></span></code></pre></td></tr></table></div></div><p>B3. Register start script:</p><div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-1">1</a></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-2">2</a></span></code></pre></td><td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>sudo chmod<span style="color:#bd93f9">755</span> /etc/init.d/vboxmount</span></span><span style="display:flex;"><span>sudo update-rc.d vboxmount defaults</span></span></code></pre></td></tr></table></div></div><h3 id="optional-read-more-about">(Optional) Read more about</h3><p><a href="https://www.virtualbox.org/manual/ch08.html" target="_blank">working with VirtualBox without GUI</a></p></description></item></channel></rss>